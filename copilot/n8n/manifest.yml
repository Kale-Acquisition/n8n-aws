name: n8n
type: Load Balanced Web Service

http:
  path: '/'

image:
  build: n8n.Dockerfile
  port: 5678

cpu: 2048
memory: 8192
platform: linux/x86_64
count: 1
exec: true
network:
  connect: true

variables:
  N8N_HOST: kle-n8-Publi-An5Tjt3jWfVi-833563112.us-east-1.elb.amazonaws.com
  N8N_PORT: 5678
  WEBHOOK_URL: http://kle-n8-Publi-An5Tjt3jWfVi-833563112.us-east-1.elb.amazonaws.com
  N8N_SECURE_COOKIE: 'false'
  DB_TYPE: postgresdb
  DB_POSTGRESDB_PORT: 5432
  DB_POSTGRESDB_DATABASE: n8n
  DB_POSTGRESDB_USER: n8n
  GENERIC_TIMEZONE: Europe/Berlin
  DB_POSTGRESDB_HOST: kale-n8n.c4x8ies80koe.us-east-1.rds.amazonaws.com
  DB_POSTGRESDB_SSL: 'true'
  DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED: 'false'

environments:
  prod:
    secrets:
      DB_POSTGRESDB_PASSWORD: /copilot/kle-n8n/prod/secrets/DB_POSTGRESDB_PASSWORD
